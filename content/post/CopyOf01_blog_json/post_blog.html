---
title: "Untitled"
output: html_document
---



<pre class="r"><code>Rmd_files &lt;- list.files(&quot;content&quot;, &quot;\\.Rmd$&quot;, recursive = TRUE, full.names = TRUE)
Rmd_files</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="r"><code>list.files(&quot;content&quot;, pattern = &quot;^.*Python*.*.Rmd$&quot;,recursive = TRUE, full.names = TRUE)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="r"><code># it&#39;s better to use - or _ in file name instead of white space.
# press tab in link to refresh the rstudio preview
# need absoluate path because servr changed current working directory.
process_rmd &lt;- function(rmd_path, site_path = &quot;.&quot;) {
  # assume asset folder has same name of rmd name
  file_name &lt;- basename(rmd_path)
  asset_folder &lt;- substr(file_name, 1, nchar(file_name) - 4)
  # change relative path of assets folder to absolute path
  # to deal with encoding, there are some internal functions. just assume utf 8 here.
  # input_lines &lt;- rmarkdown:::read_lines_utf8(rmd_path, getOption(&quot;encoding&quot;))
  input_lines &lt;- readLines(rmd_path)
  input_lines &lt;- gsub(paste0(&quot;](&quot;, asset_folder, &quot;/&quot;), 
                      paste0(&quot;](/&quot;, asset_folder, &quot;/&quot;),
                      input_lines, fixed = TRUE)
  post_path &lt;- file.path(site_path, &quot;content&quot;, &quot;post&quot;, file_name)
  writeLines(input_lines, post_path)
  # copy asset folder to static/. also assume using / instead of \
  asset_path &lt;- file.path(dirname(rmd_path), asset_folder)
  static_path &lt;- file.path(site_path, &quot;static&quot;)
  file.copy(asset_path, static_path, recursive = TRUE)
}</code></pre>
<pre class="r"><code>folder&lt;-getwd()
filename&lt;-list.files(folder, pattern = &quot;\\.Rmd$&quot;,recursive = TRUE, full.names = TRUE)[1]
filename</code></pre>
<pre><code>## [1] &quot;/home/danny/00_blog/content/post/CopyOf01_blog_json/blog.Rmd&quot;</code></pre>
<pre class="r"><code>#file &lt;- substr(filename, 1, nchar(filename) - 4)
#file


#rmd_path=paste0(folder,&quot;/&quot;,file,&quot;.Rmd&quot;)
rmd_path=filename

site_path = &quot;/home/danny/00_blog&quot;

 file_name &lt;- basename(rmd_path)
  asset_folder &lt;- substr(file_name, 1, nchar(file_name) - 4)
  # change relative path of assets folder to absolute path
  # to deal with encoding, there are some internal functions. just assume utf 8 here.
  # input_lines &lt;- rmarkdown:::read_lines_utf8(rmd_path, getOption(&quot;encoding&quot;))
  input_lines &lt;- readLines(rmd_path)</code></pre>
<pre><code>## Warning in readLines(rmd_path): incomplete final line found on &#39;/home/
## danny/00_blog/content/post/CopyOf01_blog_json/blog.Rmd&#39;</code></pre>
<pre class="r"><code>  input_lines &lt;- gsub(paste0(&quot;](&quot;, asset_folder, &quot;/&quot;), 
                      paste0(&quot;](/&quot;, asset_folder, &quot;/&quot;),
                      input_lines, fixed = TRUE)
    input_lines &lt;- gsub(paste0(&#39;image: \&quot;img/cover.jpg\&quot;&#39;), 
                      paste0(&#39;image: \&quot;&#39;, asset_folder, &#39;/blog_title.png&quot;&#39;),
                      input_lines, fixed = TRUE)
  post_path &lt;- file.path(site_path, &quot;content&quot;, &quot;post&quot;, file_name)
  writeLines(input_lines, post_path)
  # copy asset folder to static/. also assume using / instead of \
  asset_path &lt;- file.path(dirname(rmd_path), asset_folder)
  static_path &lt;- file.path(site_path, &quot;static&quot;)
  file.copy(asset_path, static_path, recursive = TRUE)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>asset_folder</code></pre>
<pre><code>## [1] &quot;blog&quot;</code></pre>
<pre class="r"><code>Sys.setenv(asset_folder = asset_folder)</code></pre>
<pre class="bash"><code>echo ${asset_folder}
cd $HOME/00_blog
ls</code></pre>
<pre><code>## blog
## 00_blog.Rproj
## Github.Rmd
## R2
## blogdown
## config.toml
## content
## index.Rmd
## layout
## public
## static
## themes</code></pre>
<pre class="r"><code>setwd(&quot;/home/danny/00_blog/&quot;)
#blogdown::serve_site()
blogdown::hugo_build()</code></pre>
<pre class="bash"><code>cd $HOME/00_blog

git add -A
git commit -m &quot;commit blog #${asset_folder})&quot;
git push</code></pre>
